(this["webpackJsonp"] = this["webpackJsonp"] || []).push([["chunk-9ef7"],{

/***/ "2Sxf":
/*!******************************************************************************************************!*\
  !*** ./src/views/project/scheduleManage/components/realTimeScheduleAll.vue?vue&type=script&lang=js& ***!
  \******************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _node_modules_happypack_loader_js_id_happyBabel_node_modules_vue_loader_lib_index_js_vue_loader_options_realTimeScheduleAll_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! -!../../../../../node_modules/happypack/loader.js?id=happyBabel!../../../../../node_modules/vue-loader/lib??vue-loader-options!./realTimeScheduleAll.vue?vue&type=script&lang=js& */ "9U3u");
/* empty/unused harmony star reexport */ /* harmony default export */ __webpack_exports__["default"] = (_node_modules_happypack_loader_js_id_happyBabel_node_modules_vue_loader_lib_index_js_vue_loader_options_realTimeScheduleAll_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0__["default"]); 

/***/ }),

/***/ "6bnF":
/*!***************************************************************************************************************!*\
  !*** ./src/views/project/scheduleManage/components/realTimeScheduleAll.vue?vue&type=style&index=0&lang=scss& ***!
  \***************************************************************************************************************/
/*! no static exports found */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _node_modules_mini_css_extract_plugin_dist_loader_js_ref_11_0_node_modules_css_loader_index_js_ref_11_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_11_2_node_modules_sass_loader_lib_loader_js_ref_11_3_node_modules_vue_loader_lib_index_js_vue_loader_options_realTimeScheduleAll_vue_vue_type_style_index_0_lang_scss___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! -!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-0!../../../../../node_modules/css-loader??ref--11-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/lib??ref--11-2!../../../../../node_modules/sass-loader/lib/loader.js??ref--11-3!../../../../../node_modules/vue-loader/lib??vue-loader-options!./realTimeScheduleAll.vue?vue&type=style&index=0&lang=scss& */ "BE5m");
/* harmony import */ var _node_modules_mini_css_extract_plugin_dist_loader_js_ref_11_0_node_modules_css_loader_index_js_ref_11_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_11_2_node_modules_sass_loader_lib_loader_js_ref_11_3_node_modules_vue_loader_lib_index_js_vue_loader_options_realTimeScheduleAll_vue_vue_type_style_index_0_lang_scss___WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_node_modules_mini_css_extract_plugin_dist_loader_js_ref_11_0_node_modules_css_loader_index_js_ref_11_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_11_2_node_modules_sass_loader_lib_loader_js_ref_11_3_node_modules_vue_loader_lib_index_js_vue_loader_options_realTimeScheduleAll_vue_vue_type_style_index_0_lang_scss___WEBPACK_IMPORTED_MODULE_0__);
/* harmony reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in _node_modules_mini_css_extract_plugin_dist_loader_js_ref_11_0_node_modules_css_loader_index_js_ref_11_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_11_2_node_modules_sass_loader_lib_loader_js_ref_11_3_node_modules_vue_loader_lib_index_js_vue_loader_options_realTimeScheduleAll_vue_vue_type_style_index_0_lang_scss___WEBPACK_IMPORTED_MODULE_0__) if(__WEBPACK_IMPORT_KEY__ !== 'default') (function(key) { __webpack_require__.d(__webpack_exports__, key, function() { return _node_modules_mini_css_extract_plugin_dist_loader_js_ref_11_0_node_modules_css_loader_index_js_ref_11_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_11_2_node_modules_sass_loader_lib_loader_js_ref_11_3_node_modules_vue_loader_lib_index_js_vue_loader_options_realTimeScheduleAll_vue_vue_type_style_index_0_lang_scss___WEBPACK_IMPORTED_MODULE_0__[key]; }) }(__WEBPACK_IMPORT_KEY__));
 /* harmony default export */ __webpack_exports__["default"] = (_node_modules_mini_css_extract_plugin_dist_loader_js_ref_11_0_node_modules_css_loader_index_js_ref_11_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_11_2_node_modules_sass_loader_lib_loader_js_ref_11_3_node_modules_vue_loader_lib_index_js_vue_loader_options_realTimeScheduleAll_vue_vue_type_style_index_0_lang_scss___WEBPACK_IMPORTED_MODULE_0___default.a); 

/***/ }),

/***/ "9U3u":
/*!*********************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/happypack/loader.js?id=happyBabel!./node_modules/vue-loader/lib??vue-loader-options!./src/views/project/scheduleManage/components/realTimeScheduleAll.vue?vue&type=script&lang=js& ***!
  \*********************************************************************************************************************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! babel-runtime/regenerator */ "14Xm");
/* harmony import */ var babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! babel-runtime/helpers/extends */ "QbLZ");
/* harmony import */ var babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! babel-runtime/helpers/asyncToGenerator */ "D3Ub");
/* harmony import */ var babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _components_MyCard__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/components/MyCard */ "zY4l");
/* harmony import */ var _directive_waves__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/directive/waves */ "ZySA");
/* harmony import */ var _api_project_wbs_index__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/api/project/wbs/index */ "OtBW");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @/utils */ "7Qib");
/* harmony import */ var _colorList__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./colorList */ "/oPa");
/* harmony import */ var _script_ganttUtils__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../script/ganttUtils */ "aZkf");
/* harmony import */ var _script_ganttConfig__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../script/ganttConfig */ "nsu0");



//
//
//
//
//
//
//
//
//
//
//
//
//










/* harmony default export */ __webpack_exports__["default"] = ({
  components: {
    MyCard: _components_MyCard__WEBPACK_IMPORTED_MODULE_3__["default"],
    colorList: _colorList__WEBPACK_IMPORTED_MODULE_7__["default"]
  },
  directives: { waves: _directive_waves__WEBPACK_IMPORTED_MODULE_4__["default"] },
  data: function data() {
    return {
      tasks: {
        data: []
      },
      ganttId: 'realTimeScheduleAll',
      loading: false,
      bidOptions: [],
      listQuery: {
        tendersId: null,
        allPlanStatus: 1
      }
    };
  },
  mounted: function mounted() {
    this.getBidOptions();
    this.initGantt();
  },


  methods: {
    getBidOptions: function getBidOptions() {
      var _this = this;

      Object(_api_project_wbs_index__WEBPACK_IMPORTED_MODULE_5__["userTenders"])({}).then(function (res) {
        console.log(res);
        if (res.success) {
          if (!res.result) return;
          _this.bidOptions = res.result;
          _this.bidOptions.unshift({
            name: '总体计划',
            id: null
          });
        }
      });
    },
    getBid: function getBid(val) {
      if (!val) {
        this.listQuery.allPlanStatus = 1;
      } else {
        delete this.listQuery.allPlanStatus;
      }
      // 重新进行视图的初始化
      this.initGantt();
    },
    initGantt: function initGantt() {
      var _this2 = this;

      document.getElementById(this.ganttId).style.height = document.getElementById('app').clientHeight - 270 + 'px';
      Object(_script_ganttConfig__WEBPACK_IMPORTED_MODULE_9__["ganttConfig"])();
      gantt.config.columns = [{
        name: 'text',
        label: '任务名称',
        template: _script_ganttUtils__WEBPACK_IMPORTED_MODULE_8__["generateTemplateLabel"],
        tree: true,
        width: 280,
        resize: true
      }, {
        name: 'code',
        label: '作业代码',
        align: 'center',
        width: 100,
        resize: true
      }, {
        name: 'duration',
        label: '工期',
        align: 'center',
        width: 100,
        resize: true
      }, {
        name: 'start_date',
        label: '计划开始',
        align: 'center',
        width: 100,
        resize: true
      }, {
        name: 'end_date',
        label: '计划完成（插件自己汇总的） ',
        align: 'center',
        hide: true,
        width: 100,
        resize: true
      }, {
        name: 'show_end_date',
        label: '计划完成 ',
        align: 'center',
        width: 100,
        resize: true
      }, {
        name: 'real_start_date',
        label: '实际开始',
        align: 'center',
        width: 100,
        resize: true
      }, {
        name: 'real_end_date',
        label: '实际完成',
        align: 'center',
        width: 100,
        resize: true
      }];

      gantt.init(this.ganttId);
      gantt.clearAll();
      // 初始化 滚动条至 0，0
      gantt.scrollTo(0, 0);
      this.realTimeScheduleList().then(function () {
        _this2.addRealTimeLine();
      });
    },
    addRealTimeLine: function addRealTimeLine() {
      gantt.locale.labels.section_baseline = 'Planned';
      // adding baseline display
      var renderFn = function renderFn(task) {
        if (task.real_start_date) {
          var formatFunc = gantt.date.str_to_date('%Y-%m-%d');
          var from = formatFunc(task.real_start_date);
          var to = task.real_end_date ? formatFunc(task.real_end_date) : new Date();
          var sizes = gantt.getTaskPosition(task, from, to);
          var el = document.createElement('div');
          el.className = 'baseline';
          el.style.left = sizes.left + 'px';
          el.style.width = sizes.width + 'px';
          el.style.top = sizes.top + gantt.config.task_height + 13 + 'px';
          return el;
        }
        return false;
      };
      gantt.addTaskLayer({
        renderer: {
          render: renderFn,
          update: renderFn,
          // define getRectangle in order to hook layer with the smart rendering
          getRectangle: function getRectangle(task, view) {
            if (task.real_start_date) {
              var formatFunc = gantt.date.str_to_date('%Y-%m-%d');
              var from = formatFunc(task.real_start_date);
              var to = task.real_end_date ? formatFunc(task.real_end_date) : new Date();

              return gantt.getTaskPosition(task, from, to);
            }
            return null;
          }
        }
      });

      gantt.render();
    },

    // 处理节点的展开处理
    dealNodeOpen: function dealNodeOpen(node) {
      // 如果为标段执行计划 就不展开子节点
      if (node.type === 'tenders_execute_plan') {
        node.open = false;
      } else {
        node.open = true;
      }
      return node;
    },
    realTimeScheduleList: function realTimeScheduleList() {
      var _this3 = this;

      return babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2___default()( /*#__PURE__*/babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _callee() {
        return babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                _this3.loading = true;
                return _context.abrupt('return', Object(_api_project_wbs_index__WEBPACK_IMPORTED_MODULE_5__["realTimeScheduleList"])(babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_1___default()({}, _this3.listQuery)).then(function (res) {
                  if (res.success) {
                    var data = res.result.map(function (item) {
                      item = _this3.dealNodeOpen(item); // 处理节点的是否展开的逻辑

                      if (item.mbsId) {
                        return babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_1___default()({}, item, {
                          id: 'mbsId_' + item.parentId + '_' + item.mbsId,
                          realType: item.type,
                          text: item.mbsName,
                          start_date: item.planStartDate ? Object(_utils__WEBPACK_IMPORTED_MODULE_6__["parseTime"])(item.planStartDate, '{d}-{m}-{y}') : '',
                          // 修正进度条显示不包含未尾天的处理
                          end_date: item.planEndDate ? Object(_utils__WEBPACK_IMPORTED_MODULE_6__["parseTime"])(new Date(item.planEndDate).getTime() + 24 * 60 * 60 * 1000, '{d}-{m}-{y}') : '',
                          show_end_date: item.planEndDate ? Object(_utils__WEBPACK_IMPORTED_MODULE_6__["parseTime"])(item.planEndDate, '{y}-{m}-{d}') : '',
                          real_start_date: item.startDate ? Object(_utils__WEBPACK_IMPORTED_MODULE_6__["parseTime"])(item.startDate, '{y}-{m}-{d}') : '',
                          real_end_date: item.endDate ? Object(_utils__WEBPACK_IMPORTED_MODULE_6__["parseTime"])(item.endDate, '{y}-{m}-{d}') : '',
                          duration: item.duration ? item.duration.slice(0, -1) : '',
                          parent: item.parentId
                        });
                      } else {
                        return babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_1___default()({}, item, {
                          id: item.id,
                          text: item.name,
                          realType: item.type,
                          start_date: item.planStartDate ? Object(_utils__WEBPACK_IMPORTED_MODULE_6__["parseTime"])(item.planStartDate, '{d}-{m}-{y}') : '',
                          // 修正进度条显示不包含未尾天的处理  + 24 * 60 * 60 * 60 * 1000
                          end_date: item.planEndDate ? Object(_utils__WEBPACK_IMPORTED_MODULE_6__["parseTime"])(new Date(item.planEndDate).getTime() + 24 * 60 * 60 * 1000, '{d}-{m}-{y}') : '',
                          show_end_date: item.planEndDate ? Object(_utils__WEBPACK_IMPORTED_MODULE_6__["parseTime"])(item.planEndDate, '{y}-{m}-{d}') : '',
                          real_start_date: item.startDate ? Object(_utils__WEBPACK_IMPORTED_MODULE_6__["parseTime"])(item.startDate, '{y}-{m}-{d}') : '',
                          real_end_date: item.endDate ? Object(_utils__WEBPACK_IMPORTED_MODULE_6__["parseTime"])(item.endDate, '{y}-{m}-{d}') : '',
                          duration: item.duration ? item.duration.slice(0, -1) : '',
                          parent: item.parentId
                        });
                      }
                    });
                    _this3.tasks.data = data;
                    gantt.parse(_this3.tasks);
                    _this3.loading = false;
                  }
                }));

              case 2:
              case 'end':
                return _context.stop();
            }
          }
        }, _callee, _this3);
      }))();
    }
  }
});

/***/ }),

/***/ "BE5m":
/*!*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-0!./node_modules/css-loader??ref--11-1!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/lib??ref--11-2!./node_modules/sass-loader/lib/loader.js??ref--11-3!./node_modules/vue-loader/lib??vue-loader-options!./src/views/project/scheduleManage/components/realTimeScheduleAll.vue?vue&type=style&index=0&lang=scss& ***!
  \*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

// extracted by mini-css-extract-plugin

/***/ }),

/***/ "MmYd":
/*!************************************************************************************************************!*\
  !*** ./src/views/project/scheduleManage/components/realTimeScheduleAll.vue?vue&type=template&id=52921652& ***!
  \************************************************************************************************************/
/*! exports provided: render, staticRenderFns */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _node_modules_vue_loader_lib_loaders_templateLoader_js_vue_loader_options_node_modules_vue_loader_lib_index_js_vue_loader_options_realTimeScheduleAll_vue_vue_type_template_id_52921652___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! -!../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../node_modules/vue-loader/lib??vue-loader-options!./realTimeScheduleAll.vue?vue&type=template&id=52921652& */ "wCZG");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "render", function() { return _node_modules_vue_loader_lib_loaders_templateLoader_js_vue_loader_options_node_modules_vue_loader_lib_index_js_vue_loader_options_realTimeScheduleAll_vue_vue_type_template_id_52921652___WEBPACK_IMPORTED_MODULE_0__["render"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "staticRenderFns", function() { return _node_modules_vue_loader_lib_loaders_templateLoader_js_vue_loader_options_node_modules_vue_loader_lib_index_js_vue_loader_options_realTimeScheduleAll_vue_vue_type_template_id_52921652___WEBPACK_IMPORTED_MODULE_0__["staticRenderFns"]; });



/***/ }),

/***/ "PRbA":
/*!*****************************************************************************!*\
  !*** ./src/views/project/scheduleManage/components/realTimeScheduleAll.vue ***!
  \*****************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _realTimeScheduleAll_vue_vue_type_template_id_52921652___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./realTimeScheduleAll.vue?vue&type=template&id=52921652& */ "MmYd");
/* harmony import */ var _realTimeScheduleAll_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./realTimeScheduleAll.vue?vue&type=script&lang=js& */ "2Sxf");
/* empty/unused harmony star reexport *//* harmony import */ var _realTimeScheduleAll_vue_vue_type_style_index_0_lang_scss___WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./realTimeScheduleAll.vue?vue&type=style&index=0&lang=scss& */ "6bnF");
/* harmony import */ var _node_modules_vue_loader_lib_runtime_componentNormalizer_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js */ "KHd+");






/* normalize component */

var component = Object(_node_modules_vue_loader_lib_runtime_componentNormalizer_js__WEBPACK_IMPORTED_MODULE_3__["default"])(
  _realTimeScheduleAll_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_1__["default"],
  _realTimeScheduleAll_vue_vue_type_template_id_52921652___WEBPACK_IMPORTED_MODULE_0__["render"],
  _realTimeScheduleAll_vue_vue_type_template_id_52921652___WEBPACK_IMPORTED_MODULE_0__["staticRenderFns"],
  false,
  null,
  null,
  null
  
)

component.options.__file = "realTimeScheduleAll.vue"
/* harmony default export */ __webpack_exports__["default"] = (component.exports);

/***/ }),

/***/ "wCZG":
/*!******************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/vue-loader/lib??vue-loader-options!./src/views/project/scheduleManage/components/realTimeScheduleAll.vue?vue&type=template&id=52921652& ***!
  \******************************************************************************************************************************************************************************************************************************************/
/*! exports provided: render, staticRenderFns */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "render", function() { return render; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "staticRenderFns", function() { return staticRenderFns; });
var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:"realTimeScheduleAllDiv"},[_c('div',{staticClass:"banner flex flex-middle"},[_c('el-select',{attrs:{"placeholder":"请选择标段"},on:{"change":_vm.getBid},model:{value:(_vm.listQuery.tendersId),callback:function ($$v) {_vm.$set(_vm.listQuery, "tendersId", $$v)},expression:"listQuery.tendersId"}},_vm._l((_vm.bidOptions),function(item){return _c('el-option',{key:item.id,attrs:{"label":item.name,"value":item.id}})}),1),_vm._v(" "),_c('colorList',{attrs:{"type":"realTime"}})],1),_vm._v(" "),_c('div',{directives:[{name:"loading",rawName:"v-loading",value:(_vm.loading),expression:"loading"}],ref:"gantt",attrs:{"id":_vm.ganttId}})])}
var staticRenderFns = []



/***/ })

}]);