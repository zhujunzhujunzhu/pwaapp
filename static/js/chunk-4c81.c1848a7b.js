(this["webpackJsonp"] = this["webpackJsonp"] || []).push([["chunk-4c81"],{

/***/ "3k16":
/*!*********************************************************************************************!*\
  !*** ./src/views/project/investControl/investPlan/commandPlan.vue?vue&type=script&lang=js& ***!
  \*********************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _node_modules_happypack_loader_js_id_happyBabel_node_modules_vue_loader_lib_index_js_vue_loader_options_commandPlan_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! -!../../../../../node_modules/happypack/loader.js?id=happyBabel!../../../../../node_modules/vue-loader/lib??vue-loader-options!./commandPlan.vue?vue&type=script&lang=js& */ "Ium4");
/* empty/unused harmony star reexport */ /* harmony default export */ __webpack_exports__["default"] = (_node_modules_happypack_loader_js_id_happyBabel_node_modules_vue_loader_lib_index_js_vue_loader_options_commandPlan_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0__["default"]); 

/***/ }),

/***/ "Ip5D":
/*!******************************************************************************************************************************!*\
  !*** ./src/views/project/investControl/investPlan/commandPlan.vue?vue&type=style&index=0&id=bd040c8c&scoped=true&lang=scss& ***!
  \******************************************************************************************************************************/
/*! no static exports found */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _node_modules_mini_css_extract_plugin_dist_loader_js_ref_11_0_node_modules_css_loader_index_js_ref_11_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_11_2_node_modules_sass_loader_lib_loader_js_ref_11_3_node_modules_vue_loader_lib_index_js_vue_loader_options_commandPlan_vue_vue_type_style_index_0_id_bd040c8c_scoped_true_lang_scss___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! -!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-0!../../../../../node_modules/css-loader??ref--11-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/lib??ref--11-2!../../../../../node_modules/sass-loader/lib/loader.js??ref--11-3!../../../../../node_modules/vue-loader/lib??vue-loader-options!./commandPlan.vue?vue&type=style&index=0&id=bd040c8c&scoped=true&lang=scss& */ "SSjP");
/* harmony import */ var _node_modules_mini_css_extract_plugin_dist_loader_js_ref_11_0_node_modules_css_loader_index_js_ref_11_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_11_2_node_modules_sass_loader_lib_loader_js_ref_11_3_node_modules_vue_loader_lib_index_js_vue_loader_options_commandPlan_vue_vue_type_style_index_0_id_bd040c8c_scoped_true_lang_scss___WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_node_modules_mini_css_extract_plugin_dist_loader_js_ref_11_0_node_modules_css_loader_index_js_ref_11_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_11_2_node_modules_sass_loader_lib_loader_js_ref_11_3_node_modules_vue_loader_lib_index_js_vue_loader_options_commandPlan_vue_vue_type_style_index_0_id_bd040c8c_scoped_true_lang_scss___WEBPACK_IMPORTED_MODULE_0__);
/* harmony reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in _node_modules_mini_css_extract_plugin_dist_loader_js_ref_11_0_node_modules_css_loader_index_js_ref_11_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_11_2_node_modules_sass_loader_lib_loader_js_ref_11_3_node_modules_vue_loader_lib_index_js_vue_loader_options_commandPlan_vue_vue_type_style_index_0_id_bd040c8c_scoped_true_lang_scss___WEBPACK_IMPORTED_MODULE_0__) if(__WEBPACK_IMPORT_KEY__ !== 'default') (function(key) { __webpack_require__.d(__webpack_exports__, key, function() { return _node_modules_mini_css_extract_plugin_dist_loader_js_ref_11_0_node_modules_css_loader_index_js_ref_11_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_11_2_node_modules_sass_loader_lib_loader_js_ref_11_3_node_modules_vue_loader_lib_index_js_vue_loader_options_commandPlan_vue_vue_type_style_index_0_id_bd040c8c_scoped_true_lang_scss___WEBPACK_IMPORTED_MODULE_0__[key]; }) }(__WEBPACK_IMPORT_KEY__));
 /* harmony default export */ __webpack_exports__["default"] = (_node_modules_mini_css_extract_plugin_dist_loader_js_ref_11_0_node_modules_css_loader_index_js_ref_11_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_11_2_node_modules_sass_loader_lib_loader_js_ref_11_3_node_modules_vue_loader_lib_index_js_vue_loader_options_commandPlan_vue_vue_type_style_index_0_id_bd040c8c_scoped_true_lang_scss___WEBPACK_IMPORTED_MODULE_0___default.a); 

/***/ }),

/***/ "Ium4":
/*!************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/happypack/loader.js?id=happyBabel!./node_modules/vue-loader/lib??vue-loader-options!./src/views/project/investControl/investPlan/commandPlan.vue?vue&type=script&lang=js& ***!
  \************************************************************************************************************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var babel_runtime_core_js_object_get_own_property_descriptor__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! babel-runtime/core-js/object/get-own-property-descriptor */ "JO7F");
/* harmony import */ var babel_runtime_core_js_object_get_own_property_descriptor__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(babel_runtime_core_js_object_get_own_property_descriptor__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! babel-runtime/helpers/defineProperty */ "YEIV");
/* harmony import */ var babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! babel-runtime/helpers/extends */ "QbLZ");
/* harmony import */ var babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var babel_runtime_core_js_object_keys__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! babel-runtime/core-js/object/keys */ "GQeE");
/* harmony import */ var babel_runtime_core_js_object_keys__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(babel_runtime_core_js_object_keys__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _components_MyCard__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/components/MyCard */ "zY4l");
/* harmony import */ var _directive_initHeight__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/directive/initHeight */ "ZfXR");
/* harmony import */ var _riophae_vue_treeselect__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @riophae/vue-treeselect */ "cCY5");
/* harmony import */ var _riophae_vue_treeselect__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(_riophae_vue_treeselect__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var _riophae_vue_treeselect_dist_vue_treeselect_css__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @riophae/vue-treeselect/dist/vue-treeselect.css */ "VCwm");
/* harmony import */ var _riophae_vue_treeselect_dist_vue_treeselect_css__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(_riophae_vue_treeselect_dist_vue_treeselect_css__WEBPACK_IMPORTED_MODULE_7__);
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @/utils */ "7Qib");
/* harmony import */ var _components_table_tableList__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @/components/table/tableList */ "dARg");
/* harmony import */ var _decorator_loading_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @/decorator/loading.js */ "DdcY");
/* harmony import */ var _api_project_invcbs_investPlan__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @/api/project/invcbs/investPlan */ "9dhF");
/* harmony import */ var _api_project_invcbs_commandPlan__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @/api/project/invcbs/commandPlan */ "dw9Q");





var _dec, _desc, _value, _obj;

function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) {
  var desc = {};
  Object['ke' + 'ys'](descriptor).forEach(function (key) {
    desc[key] = descriptor[key];
  });
  desc.enumerable = !!desc.enumerable;
  desc.configurable = !!desc.configurable;

  if ('value' in desc || desc.initializer) {
    desc.writable = true;
  }

  desc = decorators.slice().reverse().reduce(function (desc, decorator) {
    return decorator(target, property, desc) || desc;
  }, desc);

  if (context && desc.initializer !== void 0) {
    desc.value = desc.initializer ? desc.initializer.call(context) : void 0;
    desc.initializer = undefined;
  }

  if (desc.initializer === void 0) {
    Object['define' + 'Property'](target, property, desc);
    desc = null;
  }

  return desc;
}

//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//

// src\views\project\investControl\investPlan\commandPlan.vue
// src\views\project\scheduleManage\script\ganttUtils.js









/* harmony default export */ __webpack_exports__["default"] = ({
  name: 'CommandPlan',
  components: {
    MyCard: _components_MyCard__WEBPACK_IMPORTED_MODULE_4__["default"],
    Treeselect: _riophae_vue_treeselect__WEBPACK_IMPORTED_MODULE_6___default.a,
    TableList: _components_table_tableList__WEBPACK_IMPORTED_MODULE_9__["default"]
  },
  directives: {
    initHeight: _directive_initHeight__WEBPACK_IMPORTED_MODULE_5__["default"]
  },
  data: function data() {
    return {
      labelName: {
        name: '11111'
      },
      dialogListQuery: {},
      beenAdjust: true,
      buttonLoading: false,
      dialogVisible: false,
      commandPlanForm: {},
      tableShow: true,
      id: null,
      totalityColumns: [],
      yearQuarterColumns: [],
      yearMonthColumns: [],
      switchShow: false, // 选择按钮的显隐
      changeSwitch: false,
      normalizer: function normalizer(node) {
        return {
          id: node.id,
          label: node.name,
          children: node.children
        };
      },

      periodType: 'month',
      rules: {},
      dialogRules: {
        transmitAmount: [{ required: true, message: '请输入发布计划', trigger: 'change' }],
        modifiedAmount: [{ required: true, message: '请输入发布计划', trigger: 'change' }]
      },
      listQuery: {},
      treeData: [],
      treeDataTwo: [],
      treeList: {
        id: null
      },
      valId: 0,
      columns: [],
      listLoading: false,
      list: [],
      listAll: [],
      backupList: []
    };
  },
  mounted: function mounted() {
    document.getElementsByClassName('mxCard')[0].style.minHeight = document.getElementById('app').clientHeight - 300 + 'px';
    this.initTree();
    // this.releaseInvPlanData()
  },
  activated: function activated() {
    this.releaseInvPlanData();
    this.releaseMQPlanData(this.periodType, this.valId);
  },

  methods: (_dec = Object(_decorator_loading_js__WEBPACK_IMPORTED_MODULE_10__["validLoading"])('commandPlanDialog', 'buttonLoading'), (_obj = {
    /**
     * 获取treeSelect时间树的数据
     * @function initTree
     */
    initTree: function initTree() {
      var _this = this;

      // 获得时间树
      // const year = new Date().getFullYear()
      // const startData = year + '年'
      Object(_api_project_invcbs_investPlan__WEBPACK_IMPORTED_MODULE_11__["getInvestPlanTree"])({}).then(function (res) {
        if (res.success) {
          var result = [];
          res.result.forEach(function (item) {
            if (item.treeLevel < 3) {
              result.push(item);
            }
            if (item.treeLevel === 1) {
              _this.treeList.id = item.id;
            }
          });
          _this.treeData = Object(_utils__WEBPACK_IMPORTED_MODULE_8__["treeListUtil"])(result);
          _this.backupList = Object(_utils__WEBPACK_IMPORTED_MODULE_8__["deepCloneArray"])(res.result);
          _this.dunamicColumns(_this.treeList.id);
        }
      });
    },

    /**
     * 对象数组去重
     * @function reduceFun
     * @param val 需要去重的对象数组
     */
    reduceFun: function reduceFun(val) {
      var obj = {};
      return val.reduce(function (prev, element) {
        obj[element.name] ? '' : obj[element.name] = true && prev.push(element);
        return prev;
      }, []);
    },

    /**
     * 点击周期树事件
     * @function nodeClick
     * @param val 被点击的数据
     */
    nodeClick: function nodeClick(val) {
      var _this2 = this;

      this.tableShow = false;
      if (val.invPlanType === 'totality') {
        this.valId = val.id;
        this.releaseInvPlanData();
        this.dunamicColumns(val.id, this.changeSwitch);
        this.switchShow = false;
      } else if (val.invPlanType === 'yearly') {
        this.valId = val.id;
        this.switchShow = true;
        if (this.changeSwitch) {
          this.periodType = 'quarter';
          this.releaseMQPlanData(this.periodType, val.id);

          this.dealResidueColumns(val.id, this.changeSwitch);
        } else {
          this.periodType = 'month';
          this.releaseMQPlanData(this.periodType, val.id);
          this.dealResidueColumns(val.id, this.changeSwitch);
        }
      } else {
        this.$message({ message: '暂无下达计划' });
      }
      this.$nextTick(function () {
        _this2.tableShow = true;
      });
    },

    /**
     * 标段排序
     * @function sortNumber
     * @param val {String} 数组中对象字段
     */
    // 处理标段排序
    sortNumber: function sortNumber(val) {
      return function (a, b) {
        return a[val] - b[val];
      };
    },

    /**
     * 接口releaseInvPlanData的调用
     * @function releaseInvPlanData
     */
    releaseInvPlanData: function releaseInvPlanData() {
      var _this3 = this;

      this.list = [];
      var middleList = [];
      var listAll = [];
      Object(_api_project_invcbs_commandPlan__WEBPACK_IMPORTED_MODULE_12__["releaseInvPlanData"])({ invPlanType: 'yearly' }).then(function (res) {
        if (res.success) {
          if (res.result) {
            babel_runtime_core_js_object_keys__WEBPACK_IMPORTED_MODULE_3___default()(res.result.totalMap).forEach(function (val) {
              if (val === '9999') {
                res.result.totalMap['totalAmount'] = res.result.totalMap[val] || res.result.totalMap[val] === 0 ? Math.round(res.result.totalMap[val] / 10000) : '-';
              } else {
                res.result.totalMap[val + 'approvedAmount'] = res.result.totalMap[val] || res.result.totalMap[val] === 0 ? Math.round(res.result.totalMap[val] / 10000) : '-';
              }
            });
            res.result.dataList.forEach(function (item) {
              var _extends2;

              // year获取到当前年份，对approvedAmount进行拼接，表头通过周期树变化，所以表头对应的字段也不同
              item.totalAmount = Math.round(item.totalAmount / 10000);
              // const year = parseTime(item.planStartDate, '{y}') + 'approvedAmount'
              var yearTwo = item.invPlanId + 'approvedAmount';
              var lastCommandAmount = item.invPlanId + 'lastCommandAmount';
              var buttonStatus = item.invPlanId + 'buttonStatus';
              var list = babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_2___default()({}, item, (_extends2 = {}, babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_1___default()(_extends2, buttonStatus, item.buttonStatus ? item.buttonStatus : '0'), babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_1___default()(_extends2, lastCommandAmount, item.lastCommandAmount || item.lastCommandAmount === 0 ? Math.round(item.lastCommandAmount / 10000) : '-'), babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_1___default()(_extends2, yearTwo, item.resultAmount || item.resultAmount === 0 ? Math.round(item.resultAmount / 10000) : '-'), _extends2));
              listAll.push(list);
            });
            // reduceData 为降重后的数据，然后在对元数据进行比较，将有重复name的数据中，不同属性的数据拼接在一起
            var reduceData = _this3.reduceFun(listAll);
            reduceData.forEach(function (item) {
              var parameter = {};
              listAll.forEach(function (val) {
                if (val.name === item.name) {
                  parameter = babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_2___default()({}, parameter, val);
                }
              });
              middleList.push(parameter);
            });
            _this3.list = middleList.sort(_this3.sortNumber('tendersId')).concat(babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_2___default()({}, res.result.totalMap, {
              name: _this3.nameWrapper('合计')
            }));
          } else {
            _this3.list = [];
          }
        }
      });
    },

    /**
     * 接口releaseMQPlanData的调用
     * @function releaseMQPlanData
     * @param planType 计划时间树的类型
     * @param id 树的id
     */
    releaseMQPlanData: function releaseMQPlanData(planType, id) {
      var _this4 = this;

      this.list = [];
      var listAll = [];
      var middleList = [];
      Object(_api_project_invcbs_commandPlan__WEBPACK_IMPORTED_MODULE_12__["releaseMQPlanData"])({ invPlanType: planType, invPlanId: id }).then(function (res) {
        if (res.success) {
          if (res.result) {
            babel_runtime_core_js_object_keys__WEBPACK_IMPORTED_MODULE_3___default()(res.result.totalMap).forEach(function (val) {
              res.result.totalMap[val + 'approvedAmount'] = res.result.totalMap[val] || res.result.totalMap[val] === 0 ? Math.round(res.result.totalMap[val] / 10000) : '-';
            });
            res.result.dataList.forEach(function (item) {
              var _extends3;

              var approvedAmountValue = item.invPlanId + 'approvedAmount';
              var buttonStatus = item.invPlanId + 'buttonStatus';
              var lastCommandAmount = item.invPlanId + 'lastCommandAmount';
              var list = babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_2___default()({}, item, (_extends3 = {}, babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_1___default()(_extends3, buttonStatus, item.buttonStatus ? item.buttonStatus : '0'), babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_1___default()(_extends3, lastCommandAmount, item.lastCommandAmount || item.lastCommandAmount === 0 ? Math.round(item.lastCommandAmount / 10000) : '-'), babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_1___default()(_extends3, approvedAmountValue, item.resultAmount || item.resultAmount === 0 ? Math.round(item.resultAmount / 10000) : '-'), _extends3));
              listAll.push(list);
            });
            var reduceData = _this4.reduceFun(listAll);
            reduceData.forEach(function (item) {
              var parameter = {};
              listAll.forEach(function (val) {
                if (val.name === item.name) {
                  // val.amount && (item.approvedType = 'YTZ')
                  parameter = babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_2___default()({}, parameter, val);
                }
              });
              middleList.push(parameter);
            });
            _this4.list = middleList.sort(_this4.sortNumber('tendersId')).concat([babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_2___default()({}, res.result.totalMap, { name: _this4.nameWrapper('合计') })]);
          } else {
            _this4.list = [];
          }
        }
      });
    },
    nameWrapper: function nameWrapper(name) {
      if (name === '合计') {
        return '<span class=\'bottomSpan\'>' + name + '</span>';
      } else {
        return '<span  class="flex-end">' + name + '</span>';
      }
    },
    changeDate: function changeDate() {},

    /**
     * 表格操作按钮
     * @function operButton
     */
    operButton: function operButton(val) {
      if (val.invPlanId) {
        return [{
          class: 'iconyanjing',
          value: '查看',
          click: this.viewFun,
          privilege: 'P_xdjhxq_ck'
        }];
      } else {
        return [];
      }
    },

    /**
     * 查看详情按钮
     * @function viewFun
     */
    viewFun: function viewFun(val) {
      this.$storage.setStorage('commandPlanViewInfo', babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_2___default()({}, val.row, {
        changeSwitch: this.changeSwitch,
        switchShow: this.switchShow,
        detailId: this.treeList.id
      }));
      this.$router.push('commandPlanDetail');
    },

    /**
     * 点击季月的切换
     * @function switchChange
     */
    switchChange: function switchChange() {
      if (this.changeSwitch) {
        this.periodType = 'quarter';
        this.releaseMQPlanData(this.periodType, this.valId);
        this.dealResidueColumns(this.valId, this.changeSwitch);
      } else {
        this.periodType = 'month';
        this.releaseMQPlanData(this.periodType, this.valId);
        this.dealResidueColumns(this.valId, this.changeSwitch);
      }
    },
    renderTrdSeason: function renderTrdSeason(h, row, timeData) {
      var _this5 = this;

      var divStyle = 'float:right;cursor:pointer';
      var divStyleTwo = 'float:right;';
      var spanStyle = 'color:red';
      var className = 'iconfont icontuisong';
      var classNameTwo = 'iconfont icontuisong';
      var rowData = row.row;
      if (row.row[timeData.id + 'buttonStatus'] === '1') {
        var releaseBoolean = true;
        return h('div', [Object(_utils__WEBPACK_IMPORTED_MODULE_8__["judgePrivileges"])('P_xdjh_ts') ? h(
          'div',
          {
            on: {
              'click': function click() {
                for (var _len = arguments.length, row = Array(_len), _key = 0; _key < _len; _key++) {
                  row[_key] = arguments[_key];
                }

                return _this5.returnTodetail.apply(_this5, row.concat([timeData, rowData, releaseBoolean]));
              }
            },

            style: divStyle
          },
          [h('span', { 'class': className }), h('span', [row.row[timeData.id + 'approvedAmount']])]
        ) : '']);
      } else if (row.row[timeData.id + 'buttonStatus'] === '2') {
        var _releaseBoolean = false;
        return h('div', [Object(_utils__WEBPACK_IMPORTED_MODULE_8__["judgePrivileges"])('P_xdjhxq_ck') ? this.switchShow ? h(
          'div',
          { style: divStyle },
          [h('span', [row.row[timeData.id + 'lastCommandAmount']])]
        ) : h(
          'div',
          {
            on: {
              'click': function click() {
                for (var _len2 = arguments.length, row = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
                  row[_key2] = arguments[_key2];
                }

                return _this5.returnTodetail.apply(_this5, row.concat([timeData, rowData, _releaseBoolean]));
              }
            },

            style: divStyle
          },
          [h('span', [row.row[timeData.id + 'lastCommandAmount']])]
        ) : '']);
      } else if (row.row[timeData.id + 'buttonStatus'] === '3') {
        var statut = 'YTZ';
        var _releaseBoolean2 = true;
        // this.switchShow
        //             ? row.row[timeData.id + 'approvedAmount']
        return h('div', [Object(_utils__WEBPACK_IMPORTED_MODULE_8__["judgePrivileges"])('P_xdjh_ts_tz') ? h(
          'div',
          {
            on: {
              'click': function click() {
                for (var _len3 = arguments.length, row = Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {
                  row[_key3] = arguments[_key3];
                }

                return _this5.clickFun.apply(_this5, row.concat([timeData, rowData, statut, _releaseBoolean2]));
              }
            },

            style: divStyle
          },
          [h('span', { 'class': classNameTwo, style: spanStyle }), h('span', [row.row[timeData.id + 'lastCommandAmount']])]
        ) : '']);
        // approvedAmount
      } else if (row.row[timeData.id + 'buttonStatus'] === '4') {
        return h('div', [h(
          'div',
          { style: divStyleTwo },
          [h('span', ['---'])]
        )]);
      }
    },

    /**
     * 初始表头赋值
     * @function originalHeader
     */
    originalHeader: function originalHeader() {
      this.totalityColumns = [{
        text: '标段',
        value: 'name',
        sortable: false,
        required: true
      }, {
        text: '合同额',
        value: 'totalAmount',
        sortable: false,
        required: true
      }, {
        text: '操作',
        type: 'iconButton',
        fixed: 'right',
        list: this.operButton,
        width: 150
      }];
      this.yearQuarterColumns = [{
        text: '标段',
        value: 'name',
        sortable: false,
        required: true
      }, {
        text: '操作',
        type: 'iconButton',
        fixed: 'right',
        list: this.operButton,
        width: 150
      }];
      this.yearMonthColumns = [{
        text: '标段',
        value: 'name',
        sortable: false,
        required: true
      }, {
        text: '操作',
        type: 'iconButton',
        fixed: 'right',
        list: this.operButton,
        width: 150
      }];
    },

    /**
     * 表头处理函数
     * @function dunamicColumns
     * @param id id号
     * @param switchBool 季度和月度按钮是否点击
     */
    dunamicColumns: function dunamicColumns(id, switchBool) {
      var _this6 = this;

      this.columns = [];
      this.originalHeader();
      this.tableShow = false;
      var totalityColumns = [];
      // this.yearQuarterColumns.push(columnOne)
      // this.yearMonthColumns.push(columnOne)
      this.backupList.forEach(function (item) {
        if (item.invPlanType === 'yearly') {
          var value = item.name.slice(0, 4);
          var column = {
            text: value + '年',
            // value: item.id + 'approvedAmount',
            sortable: false,
            render: function render() {
              for (var _len4 = arguments.length, arg = Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {
                arg[_key4] = arguments[_key4];
              }

              return _this6.renderTrdSeason.apply(_this6, arg.concat([item]));
            },
            required: true
          };
          totalityColumns.push(column);
        }
      });
      // this.columns = this.totalityColumns.concat(totalityColumns)
      this.columns = this.totalityColumns.concat(totalityColumns);
      this.$nextTick(function () {
        _this6.tableShow = true;
      });
    },
    dealResidueColumns: function dealResidueColumns(id, switchBool) {
      var _this7 = this;

      this.columns = [];
      this.originalHeader();
      var columnOne = {
        text: '本年计划',
        value: id + 'approvedAmount',
        sortable: false,
        required: true
      };
      this.tableShow = false;
      if (switchBool) {
        var yearQuarterColumns = [];
        this.backupList.forEach(function (item) {
          if (id === item.parentId && item.invPlanType === 'quarter') {
            var reg = /(\d+)年第(\d+)季度/;
            reg.test(item.name);
            var quarter = parseInt(RegExp.$2);
            var column = {
              text: quarter + '季度',
              render: function render() {
                for (var _len5 = arguments.length, arg = Array(_len5), _key5 = 0; _key5 < _len5; _key5++) {
                  arg[_key5] = arguments[_key5];
                }

                return _this7.renderTrdSeason.apply(_this7, arg.concat([item]));
              },
              sortable: false,
              required: true
            };
            yearQuarterColumns.push(column);
          }
        });
        this.columns = this.yearQuarterColumns.concat(columnOne).concat(yearQuarterColumns);
      } else {
        var yearMonthColumns = [];
        this.backupList.forEach(function (item) {
          if (id === item.parentId) {
            _this7.backupList.forEach(function (inner) {
              if (inner.parentId === item.id && inner.invPlanType === 'month') {
                var regtwo = /(\d+)年(\d+)月/;
                regtwo.test(inner.name);
                var month = parseInt(RegExp.$2);
                _this7.id = inner.id;
                var columntwo = {
                  text: month + '月',
                  render: function render() {
                    for (var _len6 = arguments.length, arg = Array(_len6), _key6 = 0; _key6 < _len6; _key6++) {
                      arg[_key6] = arguments[_key6];
                    }

                    return _this7.renderTrdSeason.apply(_this7, arg.concat([inner]));
                  },
                  sortable: false,
                  required: true
                };
                yearMonthColumns.push(columntwo);
              }
            });
          }
        });
        this.columns = this.yearMonthColumns.concat(columnOne).concat(yearMonthColumns);
      }
      this.$nextTick(function () {
        _this7.tableShow = true;
      });
    },

    /**
     * 获得详情页的数据
     * @function invPlanDataList
     * @param tendersId 标段id
     * @param invPlanId 周期id
     */
    invPlanDataList: function invPlanDataList() {
      var _this8 = this;

      Object(_api_project_invcbs_investPlan__WEBPACK_IMPORTED_MODULE_11__["invPlanDataList"])(babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_2___default()({}, this.dialogListQuery)).then(function (res) {
        res.result.find(function (inner) {
          if (inner.treeLevel === 1) {
            if (inner.modifiedApprovedAmount || inner.modifiedApprovedAmount === 0) {
              inner.newApprovedAmount = Math.round(inner.modifiedApprovedAmount / 10000);
            } else {
              inner.newApprovedAmount = inner.approvedAmount || inner.approvedAmount === 0 ? Math.round(inner.approvedAmount / 10000) : '0';
            }
            inner.amount = inner.amount || inner.amount === 0 ? Math.round(inner.amount / 10000) : '';
            inner.lastCommandAmount = inner.lastCommandAmount || inner.lastCommandAmount === 0 ? Math.round(inner.lastCommandAmount / 10000) : '';
            inner.modifiedAmount = inner.modifiedAmount || inner.modifiedAmount === 0 ? Math.round(inner.modifiedAmount / 10000) : '';
            _this8.commandPlanForm = inner;
          }
        });
      });
    },

    /**
     * 通过审批的按钮
     * @function returnTodetail
     * @param row 当前点击位置的数据
     * @param timeData 该位置周期树的数据
     * @param rowData 当前行的数据
     * @param releaseBoolean 是否可编辑发布,月份和季度是否可点击
     */
    returnTodetail: function returnTodetail(row, timeData, rowData, releaseBoolean) {
      if (this.switchShow) {
        if (this.changeSwitch) {
          this.labelName.name = '本季计划：';
        } else {
          this.labelName.name = '本月计划：';
        }
        this.dialogListQuery.tendersId = rowData.tendersId;
        this.dialogListQuery.invPlanId = timeData.id;
        this.invPlanDataList(rowData.tendersId);
        this.beenAdjust = true;
        this.dialogVisible = true;
      } else {
        this.$storage.setStorage('commandPlanEditDetail', {
          rowData: rowData,
          treeData: timeData,
          releaseBoolean: releaseBoolean
        });
        this.$router.push('commandPlanEditDetail');
      }
    },

    /**
     * 调整通过审批的按钮
     * @function clickFun
     * @param row 当前点击位置的数据
     * @param timeData 该位置周期树的数据
     * @param rowData 当前行的数据
     * @param statut 是否为调整
     */
    clickFun: function clickFun(row, timeData, rowData, statut, releaseBoolean) {
      if (this.switchShow) {
        this.dialogListQuery.tendersId = rowData.tendersId;
        this.dialogListQuery.invPlanId = timeData.id;
        this.invPlanDataList(rowData.tendersId);
        this.beenAdjust = false;
        this.dialogVisible = true;
      } else {
        this.$storage.setStorage('commandPlanEditDetail', {
          rowData: rowData,
          statut: statut,
          treeData: timeData,
          releaseBoolean: releaseBoolean
        });
        this.$router.push('commandPlanEditDetail');
      }
    },
    save: function save() {
      var _this9 = this;

      //  beenAdjust transmitAmount
      var lastCommandAmount = void 0;
      if (this.beenAdjust) {
        lastCommandAmount = this.commandPlanForm.modifiedAmount;
      } else {
        lastCommandAmount = this.commandPlanForm.transmitAmount;
      }
      return Object(_api_project_invcbs_investPlan__WEBPACK_IMPORTED_MODULE_11__["changeReleaseStatus"])(babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_2___default()({}, this.dialogListQuery, {
        lastCommandAmount: lastCommandAmount
      })).then(function (res) {
        _this9.dialogVisible = false;
        _this9.releaseMQPlanData(_this9.periodType, _this9.valId);
      });
    },

    /**
     * 关闭el-dialog
     * @function close
     */
    close: function close() {
      this.dialogVisible = false;
    }
  }, (_applyDecoratedDescriptor(_obj, 'save', [_dec], babel_runtime_core_js_object_get_own_property_descriptor__WEBPACK_IMPORTED_MODULE_0___default()(_obj, 'save'), _obj)), _obj))
});

/***/ }),

/***/ "SSjP":
/*!************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-0!./node_modules/css-loader??ref--11-1!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/lib??ref--11-2!./node_modules/sass-loader/lib/loader.js??ref--11-3!./node_modules/vue-loader/lib??vue-loader-options!./src/views/project/investControl/investPlan/commandPlan.vue?vue&type=style&index=0&id=bd040c8c&scoped=true&lang=scss& ***!
  \************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

// extracted by mini-css-extract-plugin

/***/ }),

/***/ "Ys55":
/*!***************************************************************************************************************!*\
  !*** ./src/views/project/investControl/investPlan/commandPlan.vue?vue&type=template&id=bd040c8c&scoped=true& ***!
  \***************************************************************************************************************/
/*! exports provided: render, staticRenderFns */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _node_modules_vue_loader_lib_loaders_templateLoader_js_vue_loader_options_node_modules_vue_loader_lib_index_js_vue_loader_options_commandPlan_vue_vue_type_template_id_bd040c8c_scoped_true___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! -!../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../node_modules/vue-loader/lib??vue-loader-options!./commandPlan.vue?vue&type=template&id=bd040c8c&scoped=true& */ "wEDh");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "render", function() { return _node_modules_vue_loader_lib_loaders_templateLoader_js_vue_loader_options_node_modules_vue_loader_lib_index_js_vue_loader_options_commandPlan_vue_vue_type_template_id_bd040c8c_scoped_true___WEBPACK_IMPORTED_MODULE_0__["render"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "staticRenderFns", function() { return _node_modules_vue_loader_lib_loaders_templateLoader_js_vue_loader_options_node_modules_vue_loader_lib_index_js_vue_loader_options_commandPlan_vue_vue_type_template_id_bd040c8c_scoped_true___WEBPACK_IMPORTED_MODULE_0__["staticRenderFns"]; });



/***/ }),

/***/ "dw9Q":
/*!***********************************************!*\
  !*** ./src/api/project/invcbs/commandPlan.js ***!
  \***********************************************/
/*! exports provided: releaseInvPlanData, releaseMQPlanData, releaseInvPlanDataDetail, releaseMQPlanDataDetail, getWorkPoints */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "releaseInvPlanData", function() { return releaseInvPlanData; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "releaseMQPlanData", function() { return releaseMQPlanData; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "releaseInvPlanDataDetail", function() { return releaseInvPlanDataDetail; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "releaseMQPlanDataDetail", function() { return releaseMQPlanDataDetail; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getWorkPoints", function() { return getWorkPoints; });
/* harmony import */ var _utils_request__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/utils/request */ "t3Un");
/*
 * @Description
 * @Autor 肖扬
 * @Date 2020-05-19 10:11:58
 * @LastEditors 肖扬
 * @LastEditTime 2020-05-26 09:50:24
 */


// 下达计划总计划
function releaseInvPlanData(param) {
  return Object(_utils_request__WEBPACK_IMPORTED_MODULE_0__["default"])({
    url: 'rest/invPlan/releaseInvPlanData',
    method: 'post',
    data: param
  });
}

// 下达计划季/月度计划
function releaseMQPlanData(param) {
  return Object(_utils_request__WEBPACK_IMPORTED_MODULE_0__["default"])({
    url: 'rest/invPlan/releaseMQPlanData',
    method: 'post',
    data: param
  });
}

// 下达计划总计划
function releaseInvPlanDataDetail(param) {
  return Object(_utils_request__WEBPACK_IMPORTED_MODULE_0__["default"])({
    url: 'rest/invPlan/releaseInvPlanDataDetail',
    method: 'post',
    data: param
  });
}

// 下达计划详情季/月度计划
function releaseMQPlanDataDetail(param) {
  return Object(_utils_request__WEBPACK_IMPORTED_MODULE_0__["default"])({
    url: 'rest/invPlan/releaseMQPlanDataDetail',
    method: 'post',
    data: param
  });
}

// 工点
function getWorkPoints(param) {
  return Object(_utils_request__WEBPACK_IMPORTED_MODULE_0__["default"])({
    url: 'rest/workPoint/getWorkPoints',
    method: 'post',
    data: param
  });
}

/***/ }),

/***/ "wEDh":
/*!*********************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/vue-loader/lib??vue-loader-options!./src/views/project/investControl/investPlan/commandPlan.vue?vue&type=template&id=bd040c8c&scoped=true& ***!
  \*********************************************************************************************************************************************************************************************************************************************/
/*! exports provided: render, staticRenderFns */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "render", function() { return render; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "staticRenderFns", function() { return staticRenderFns; });
var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:"app-container CommandPlanDiv"},[_c('my-card',[_c('div',{directives:[{name:"initHeight",rawName:"v-initHeight",value:({offset:300}),expression:"{offset:300}"}],staticClass:"topDiv"},[_c('div',{staticClass:"flex flex-middle mr20px"},[_c('el-form',{ref:"listQuery",attrs:{"rules":_vm.rules,"model":_vm.listQuery,"label-position":"center","size":"small","label-width":"100px"}},[_c('el-row',[_c('el-col',{attrs:{"span":6}},[_c('el-form-item',{attrs:{"label":"周期：","prop":"time"}},[_c('treeselect',{attrs:{"options":_vm.treeData,"normalizer":_vm.normalizer,"default-expand-level":1,"no-children-text":"无选择","placeholder":"请选择时间"},on:{"select":_vm.nodeClick,"input":_vm.changeDate},model:{value:(_vm.treeList.id),callback:function ($$v) {_vm.$set(_vm.treeList, "id", $$v)},expression:"treeList.id"}})],1)],1)],1)],1),_vm._v(" "),_c('div',{staticClass:"flex unitDiv"},[_c('div',[(_vm.switchShow)?_c('el-switch',{staticClass:"changeSwitch",attrs:{"width":50,"active-text":"季度","inactive-text":"月度"},on:{"change":_vm.switchChange},model:{value:(_vm.changeSwitch),callback:function ($$v) {_vm.changeSwitch=$$v},expression:"changeSwitch"}}):_vm._e()],1),_vm._v(" "),_c('div',[_c('span',{staticClass:"unitClass"},[_vm._v("单位：万")])])])],1),_vm._v(" "),_c('div',[(_vm.tableShow)?_c('table-list',{staticClass:"dataTable issucTable",attrs:{"columns":_vm.columns,"data":_vm.list,"list-loading":_vm.listLoading}}):_vm._e()],1)])]),_vm._v(" "),_c('el-dialog',{attrs:{"visible":_vm.dialogVisible,"width":"40%","close-on-click-modal":false},on:{"update:visible":function($event){_vm.dialogVisible=$event}}},[_c('el-form',{ref:"commandPlanDialog",attrs:{"rules":_vm.dialogRules,"model":_vm.commandPlanForm,"label-position":"center","size":"small","label-width":"100px"}},[(_vm.beenAdjust)?_c('el-row',[_c('el-col',{attrs:{"span":24}},[_c('el-form-item',{attrs:{"label":_vm.labelName.name}},[_c('span',[_vm._v(_vm._s(_vm.commandPlanForm.newApprovedAmount)+"(万)")])])],1),_vm._v(" "),_c('el-col',{attrs:{"span":24}},[_c('el-form-item',{attrs:{"label":"发布计划:","prop":"modifiedAmount"}},[_c('el-input',{staticStyle:{"width":"50%"},attrs:{"type":"text","placeholder":"请输入发布计划（万）"},model:{value:(_vm.commandPlanForm.modifiedAmount),callback:function ($$v) {_vm.$set(_vm.commandPlanForm, "modifiedAmount", $$v)},expression:"commandPlanForm.modifiedAmount"}})],1)],1)],1):_c('el-row',[_c('el-col',{attrs:{"span":24}},[_c('el-form-item',{attrs:{"label":"原发布计划:"}},[_c('span',[_vm._v(_vm._s(_vm.commandPlanForm.lastCommandAmount)+"(万)")])])],1),_vm._v(" "),_c('el-col',{staticStyle:{"margin-bottom":"20px"},attrs:{"span":24}},[_c('label',[_vm._v("现在调整计划：")]),_vm._v(" "),_c('span',[_vm._v(_vm._s(_vm.commandPlanForm.modifiedAmount||_vm.commandPlanForm.modifiedAmount===0?_vm.commandPlanForm.modifiedAmount: _vm.commandPlanForm.amount)+"(万)")])]),_vm._v(" "),_c('el-col',{attrs:{"span":24}},[_c('el-form-item',{attrs:{"label":"发布计划:","prop":"transmitAmount"}},[_c('el-input',{staticStyle:{"width":"50%"},attrs:{"type":"text","placeholder":"请输入发布计划（万）"},model:{value:(_vm.commandPlanForm.transmitAmount),callback:function ($$v) {_vm.$set(_vm.commandPlanForm, "transmitAmount", $$v)},expression:"commandPlanForm.transmitAmount"}})],1)],1)],1)],1),_vm._v(" "),_c('div',{staticClass:"dialog-footer",attrs:{"slot":"footer"},slot:"footer"},[_c('el-button',{directives:[{name:"waves",rawName:"v-waves"}],attrs:{"type":"primary","loading":_vm.buttonLoading},on:{"click":_vm.save}},[_vm._v("发布")]),_vm._v(" "),_c('el-button',{attrs:{"type":"primary"},on:{"click":_vm.close}},[_vm._v("取消")])],1)],1)],1)}
var staticRenderFns = []



/***/ }),

/***/ "xR7A":
/*!********************************************************************!*\
  !*** ./src/views/project/investControl/investPlan/commandPlan.vue ***!
  \********************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _commandPlan_vue_vue_type_template_id_bd040c8c_scoped_true___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./commandPlan.vue?vue&type=template&id=bd040c8c&scoped=true& */ "Ys55");
/* harmony import */ var _commandPlan_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./commandPlan.vue?vue&type=script&lang=js& */ "3k16");
/* empty/unused harmony star reexport *//* harmony import */ var _commandPlan_vue_vue_type_style_index_0_id_bd040c8c_scoped_true_lang_scss___WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./commandPlan.vue?vue&type=style&index=0&id=bd040c8c&scoped=true&lang=scss& */ "Ip5D");
/* harmony import */ var _node_modules_vue_loader_lib_runtime_componentNormalizer_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js */ "KHd+");






/* normalize component */

var component = Object(_node_modules_vue_loader_lib_runtime_componentNormalizer_js__WEBPACK_IMPORTED_MODULE_3__["default"])(
  _commandPlan_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_1__["default"],
  _commandPlan_vue_vue_type_template_id_bd040c8c_scoped_true___WEBPACK_IMPORTED_MODULE_0__["render"],
  _commandPlan_vue_vue_type_template_id_bd040c8c_scoped_true___WEBPACK_IMPORTED_MODULE_0__["staticRenderFns"],
  false,
  null,
  "bd040c8c",
  null
  
)

component.options.__file = "commandPlan.vue"
/* harmony default export */ __webpack_exports__["default"] = (component.exports);

/***/ })

}]);